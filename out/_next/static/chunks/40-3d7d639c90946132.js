"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[40],{16938:(e,t,s)=>{s.d(t,{BE:()=>l,Ck:()=>r,VO:()=>o,og:()=>d,r8:()=>c});var a=s(99572),n=s(96446);let i=new a.Q,r=e=>i.create(n.Zs,e),o=e=>i.get(n.F1,e),c=e=>i.get(n.W3,e),l=e=>i.create(n.OQ,e),d=e=>i.update(n.OE,e)},51040:(e,t,s)=>{s.d(t,{A:()=>p});var a=s(95155),n=s(66766),i=s(97612),r=s(12115),o=s(39365),c=s.n(o),l=s(91867),d=s(51770),h=s(60902),m=s(79835),u=s(16938);function p(e){let{qrId:t}=e,{showSuccess:s,showError:o}=(0,i.i)(),[p,g]=(0,r.useState)({name:"",userId:"",description:"",category:"",contactOptions:{phone:!1,email:!1,push:!1},phoneNumber:"",email:""}),[x,b]=(0,r.useState)(null),[v,j]=(0,r.useState)(!1),[f,N]=(0,r.useState)(!1),[y,C]=(0,r.useState)({}),[A,w]=(0,r.useState)(!1),[k,I]=(0,r.useState)(!1),[O,E]=(0,r.useState)(null),[S,_]=(0,r.useState)(""),[P,R]=(0,r.useState)(!0),[q,T]=(0,r.useState)(""),[D,B]=(0,r.useState)(""),[F,U]=(0,r.useState)(!1),[L,z]=(0,r.useState)(!!t);t&&(0,r.useEffect)(()=>{(async()=>{R(!0);try{let n=await (0,u.VO)({qrId:t});if(n.success){var e,s,a;g({name:n.data.name||"",userId:n.data.userId||"",description:n.data.description||"",category:n.data.category||"",contactOptions:{phone:(null==(e=n.data.contactOptions)?void 0:e.phone)||!1,email:(null==(s=n.data.contactOptions)?void 0:s.email)||!1,push:(null==(a=n.data.contactOptions)?void 0:a.push)||!1},phoneNumber:n.data.phoneNumber||"",email:n.data.email||""})}}catch(e){o(e.message),g({name:"",userId:"",description:"",category:"",contactOptions:{phone:!1,email:!1,push:!1},phoneNumber:"",email:""})}finally{R(!1)}})()},[t]);let K=e=>{let{name:t,value:s,type:a}=e.target,n=e.target.checked;"checkbox"===a?g(e=>({...e,contactOptions:{...e.contactOptions,[t]:n}})):g(e=>({...e,[t]:s}))},H=()=>{let e={};return p.name.trim()||(e.name="Name ist erforderlich"),p.userId.trim()||(e.userId="Benutzername ist erforderlich"),p.category||(e.category="Kategorie ist erforderlich"),p.contactOptions.phone||p.contactOptions.email||p.contactOptions.push||(e.contactOptions="Mindestens eine Kontaktm\xf6glichkeit ist erforderlich"),p.contactOptions.phone&&!p.phoneNumber.trim()&&(e.phoneNumber="Telefonnummer ist erforderlich"),p.contactOptions.email&&!p.email.trim()&&(e.email="E-Mail-Adresse erforderlich"),C(e),0===Object.keys(e).length},G=async e=>{if(e.preventDefault(),H()){w(!0);try{let e,a={qrId:L?"":t,name:p.name,userId:p.userId,description:p.description,category:p.category,contactOptions:p.contactOptions,phoneNumber:p.phoneNumber,email:p.email};t?(e=await (0,u.og)(a)).success?(s(e.message),I(!0)):o(e.message):(e=await (0,u.Ck)(a)).success?(I(!0),j(!0),E(e.qrCodeData),_(e.downloadUrl),s(e.message),B(e.password)):o(e.message)}catch(e){var a;console.error("Submission error:",(null==(a=e.response)?void 0:a.data)||e.message),o(e.message||"QR-Code konnte nicht generiert werden")}finally{w(!1)}}},M=async()=>{try{let e=await (0,u.BE)({qrId:t,password:q});e.success?(s(e.message),z(!1),N(!1)):o(e.message)}catch(t){var e;z(!0),console.error("Submission error:",(null==(e=t.response)?void 0:e.data)||t.message),o(t.message||"Passwort konnte nicht \xfcberpr\xfcft werden")}finally{U(!1)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"container mt-5 page-container",children:(0,a.jsx)("div",{className:"row justify-content-center",children:(0,a.jsx)("div",{className:"col-md-8",children:(0,a.jsx)("div",{className:"card shadow",children:(0,a.jsxs)("div",{className:"card-body",children:[(0,a.jsx)("div",{className:"d-flex justify-content-center",children:(0,a.jsx)(n.default,{src:"https://identqr.de/files/99/Logo_K&D_herz_orange.png",alt:"Allianz D\xf6pke / DeineTierfamilie.de",className:" object-fit-contain flex-grow-1",width:200,height:200,style:{maxWidth:"100%",maxHeight:"200px"}})}),P&&t?(0,a.jsx)("div",{className:"d-flex justify-content-center",children:(0,a.jsx)(l.A,{})}):(0,a.jsxs)("form",{onSubmit:G,children:[(0,a.jsxs)("div",{className:"row mt-md-4 mt-2",children:[(0,a.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,a.jsx)("label",{htmlFor:"name",className:"form-label",children:"Name*"}),(0,a.jsx)("input",{type:"text",className:"form-control ".concat(y.name?"is-invalid":""),id:"name",name:"name",value:p.name,onChange:K,disabled:!!t}),y.name&&(0,a.jsx)("div",{className:"invalid-feedback",children:y.name})]}),(0,a.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,a.jsx)("label",{htmlFor:"userId",className:"form-label",children:"Benutzer-ID*"}),(0,a.jsx)("input",{type:"text",className:"form-control ".concat(y.userId?"is-invalid":""),id:"userId",name:"userId",value:p.userId,onChange:K,disabled:!!t}),y.userId&&(0,a.jsx)("div",{className:"invalid-feedback",children:y.userId})]})]}),(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("label",{htmlFor:"category",className:"form-label",children:"Kategorie*"}),(0,a.jsxs)("select",{className:"form-select ".concat(y.category?"is-invalid":""),id:"category",name:"category",value:p.category,onChange:K,disabled:L,children:[(0,a.jsx)("option",{value:"",children:"W\xe4hlen Sie eine Option aus"}),(0,a.jsx)("option",{value:"dog",children:"Hund"}),(0,a.jsx)("option",{value:"cat",children:"Katze"})]}),y.category&&(0,a.jsx)("div",{className:"invalid-feedback",children:y.category})]}),(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("label",{htmlFor:"description",className:"form-label",children:"Beschreibung"}),(0,a.jsx)("textarea",{className:"form-control",id:"description",name:"description",rows:1,value:p.description,onChange:K,disabled:L})]}),(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("label",{className:"form-label",children:"Kontaktm\xf6glichkeiten*"}),(0,a.jsxs)("div",{className:"form-check",children:[(0,a.jsx)("input",{className:"form-check-input",type:"checkbox",id:"phoneCheck",name:"phone",checked:p.contactOptions.phone,onChange:K,disabled:L}),(0,a.jsx)("label",{className:"form-check-label",htmlFor:"phoneCheck",children:"Telefon"})]}),p.contactOptions.phone&&(0,a.jsxs)("div",{className:"mt-2 ms-4",children:[(0,a.jsx)(c(),{country:"us",value:p.phoneNumber,disabled:L,onChange:e=>g(t=>({...t,phoneNumber:e})),inputClass:" ".concat(y.phoneNumber?"is-invalid":""),containerClass:y.phoneNumber?"is-invalid":"",inputStyle:{width:"100%",height:"38px"}}),y.phoneNumber&&(0,a.jsx)("div",{className:"invalid-feedback",children:y.phoneNumber})]}),(0,a.jsxs)("div",{className:"form-check mt-2",children:[(0,a.jsx)("input",{className:"form-check-input",type:"checkbox",id:"emailCheck",name:"email",checked:p.contactOptions.email,onChange:K,disabled:L}),(0,a.jsx)("label",{className:"form-check-label",htmlFor:"emailCheck",children:"E-Mail"})]}),p.contactOptions.email&&(0,a.jsxs)("div",{className:"mt-2 ms-4",children:[(0,a.jsx)("input",{type:"email",className:"form-control ".concat(y.email?"is-invalid":""),id:"email",name:"email",placeholder:"Email address",value:p.email,onChange:K,disabled:L}),y.email&&(0,a.jsx)("div",{className:"invalid-feedback",children:y.email})]}),(0,a.jsxs)("div",{className:"form-check mt-2",children:[(0,a.jsx)("input",{className:"form-check-input",type:"checkbox",id:"pushCheck",name:"push",checked:p.contactOptions.push,onChange:K,disabled:L}),(0,a.jsx)("label",{className:"form-check-label",htmlFor:"pushCheck",children:"Push-Benachrichtigungen"})]})]}),y.contactOptions&&(0,a.jsx)("div",{className:"text-danger mb-2",style:{fontSize:"0.875em"},children:y.contactOptions}),(0,a.jsxs)("div",{className:"d-flex justify-content-center mt-5 gap-3",children:[(0,a.jsx)("button",{type:"submit",className:"btn btn-primary border-r-50",disabled:A||L,children:A?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Senden..."]}):"Activate"}),(0,a.jsx)("button",{type:"button",className:"btn btn-secondary border-r-50",onClick:()=>N(!0),children:"Edit"})]}),y.submit&&(0,a.jsx)("div",{className:"alert alert-danger mt-3",children:y.submit})]})]})})})})}),(0,a.jsxs)(d.A,{show:v,onHide:()=>j(!1),centered:!0,children:[(0,a.jsxs)(d.A.Body,{className:"text-center",children:[(0,a.jsx)("div",{children:S?(0,a.jsx)("img",{id:"qr-code-svg",src:S,alt:"QR Code",style:{maxWidth:"100%"}}):(0,a.jsx)("p",{children:"Kein QR-Code verf\xfcgbar."})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"me-3",children:"Passwort:"}),(0,a.jsx)("span",{children:D})]})]}),(0,a.jsxs)(d.A.Footer,{children:[(0,a.jsx)(h.A,{variant:"primary",onClick:()=>{if(!O)return;let e=document.getElementById("qr-code-svg");if(!e)return;let t=document.createElement("img"),s=e.cloneNode(!0),a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("width","100%"),a.setAttribute("height","100%"),a.setAttribute("fill","white"),s.insertBefore(a,s.firstChild);let n=new XMLSerializer().serializeToString(s),i=document.createElement("canvas"),r=i.getContext("2d");if(!r)return void console.error("Could not get canvas context");t.onload=()=>{i.width=4*t.width,i.height=4*t.height,r.scale(4,4),r.drawImage(t,0,0);let e=i.toDataURL("image/png"),s=document.createElement("a");s.download="".concat(p.name,"_").concat(p.userId,"_qrcode.png"),s.href=e,document.body.appendChild(s),s.click(),document.body.removeChild(s)},t.onerror=()=>{let e=new Blob([n],{type:"image/svg+xml"}),t=URL.createObjectURL(e),s=document.createElement("a");s.download="".concat(p.name,"_").concat(p.userId,"_qrcode.svg"),s.href=t,s.click(),URL.revokeObjectURL(t)},t.src="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(n)))},children:"QR-Code herunterladen"}),(0,a.jsx)(h.A,{variant:"secondary",onClick:()=>j(!1),children:"Schlie\xdfen"})]})]}),(0,a.jsxs)(d.A,{show:f,onHide:()=>N(!1),centered:!0,children:[(0,a.jsx)(d.A.Header,{closeButton:!0,children:(0,a.jsx)(d.A.Title,{children:"Informationen bearbeiten"})}),(0,a.jsx)(d.A.Body,{children:(0,a.jsxs)(m.A.Group,{controlId:"formPassword",children:[(0,a.jsx)(m.A.Label,{children:"Passwort"}),(0,a.jsx)(m.A.Control,{type:"password",placeholder:"Geben Sie Ihr Passwort ein",value:q,onChange:e=>T(e.target.value),disabled:A}),(0,a.jsx)(m.A.Text,{className:"text-muted",children:"Bitte geben Sie Ihr Passwort ein, um die \xc4nderungen zu best\xe4tigen"})]})}),(0,a.jsxs)(d.A.Footer,{children:[(0,a.jsx)(h.A,{variant:"secondary",onClick:()=>N(!1),disabled:F,children:"Schlie\xdfen"}),(0,a.jsx)(h.A,{variant:"primary",onClick:M,disabled:!q||F,children:A?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"spinner-border spinner-border-sm me-2","aria-hidden":"true"}),"Best\xe4tigen..."]}):"Confirm"})]})]})]})}s(30133)},61042:(e,t,s)=>{s.d(t,{SnackbarProvider:()=>c,d:()=>l});var a=s(95155),n=s(12115),i=s(75824),r=s(9665);let o=(0,n.createContext)(null),c=e=>{let{children:t}=e,[s,c]=(0,n.useState)({open:!1,message:"",severity:"info"}),l=()=>c({...s,open:!1});return(0,a.jsxs)(o.Provider,{value:(e,t)=>{c({open:!0,message:e,severity:t})},children:[t,(0,a.jsx)(i.A,{open:s.open,autoHideDuration:3e3,onClose:l,anchorOrigin:{vertical:"top",horizontal:"center"},sx:{top:"80px !important"},children:(0,a.jsx)(r.A,{onClose:l,severity:s.severity,sx:{width:"100%"},children:s.message})})]})},l=()=>(0,n.useContext)(o)},96446:(e,t,s)=>{s.d(t,{F1:()=>n,OE:()=>r,OQ:()=>i,Ou:()=>d,W3:()=>o,Zs:()=>a,aF:()=>u,b6:()=>h,s_:()=>l,wz:()=>c,yZ:()=>m});let a="/api/qrcode/generate-qrcode",n="/api/qrcode/get-qrcode-data",i="/api/qrcode/verify-password",r="/api/qrcode/update-qrcode-data",o="/api/qrcode/get-qrcode-page-token",c="/api/auth/login",l="/api/auth/forgot-password",d="/api/auth/reset-password/",h="/api/auth/logout",m="/api/dashboard/get-user-data-by-page",u="/api/dashboard/reset-qrcode-password"},97612:(e,t,s)=>{s.d(t,{i:()=>n});var a=s(61042);let n=()=>{let e=(0,a.d)();return{showSuccess:t=>e(t,"success"),showError:t=>e(t,"error"),showWarning:t=>e(t,"warning"),showInfo:t=>e(t,"info")}}},99572:(e,t,s)=>{s.d(t,{Q:()=>c});var a=s(23464),n=s(49509);let i={API_URL:"http://127.0.0.1:5000/",AUTH_BACKEND:"Dummy",FIRE_BASE:{API_KEY:n.env.REACT_APP_APIKEY,AUTH_DOMAIN:n.env.REACT_APP_AUTHDOMAIN,PROJECTID:n.env.REACT_APP_PROJECTID,STORAGEBUCKET:n.env.REACT_APP_STORAGEBUCKET,MESSAGINGSENDERID:n.env.REACT_APP_MESSAGINGSENDERID,APPID:n.env.REACT_APP_APPID}};var r=s(79971);a.A.defaults.baseURL=i.API_URL;let o=i.API_URL;a.A.defaults.headers.post["Content-Type"]="application/json",a.A.interceptors.response.use(function(e){return e.data?e.data:e});class c{request(e){return new Promise((t,s)=>{this._axios.request(e).then(e=>{t(e.data)}).catch(e=>{var t;s((null==(t=e.response)?void 0:t.data)||e.message)})})}constructor(){var e=this;this._axios=a.A.create({baseURL:o,withCredentials:!0,headers:{"Content-Type":"application/json",Accept:"application/json"}}),this.logout=()=>{(0,r.setCookie)("auth_token",""),window.location.href="/en/auth/login"},this.addRequestInterceptor=(e,t)=>{this._axios.interceptors.request.use(e,t)},this.addResponseInterceptor=(e,t)=>{this._axios.interceptors.response.use(e,t)},this.get=async function(t,s){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"json";return e.request({method:"get",url:t,params:s,responseType:a})},this.create=async(e,t)=>await this.request(this.getOptionsConfig("post",e,t)),this.put=async(e,t)=>await this.request(this.getOptionsConfig("put",e,t)),this.update=async(e,t)=>await this.request(this.getOptionsConfig("patch",e,t)),this.delete=async(e,t)=>this.request({method:"delete",url:e,params:t}),this.getOptionsConfig=(e,t,s)=>{let a={"Content-Type":"application/json"};return s instanceof FormData&&delete a["Content-Type"],{method:e,url:t,data:s,headers:a}},this._axios.interceptors.response.use(e=>e,e=>{var t,s,a,n,i,r,o,c;return((null==(t=e.response)?void 0:t.status)===401&&this.logout(),(null==(s=e.response)?void 0:s.status)===400||(null==(a=e.response)?void 0:a.status)===500||(null==(n=e.response)?void 0:n.status)===401)?Promise.resolve(e.response):(((null==(r=e.response)||null==(i=r.data)?void 0:i.message)=="Token is not valid"||(null==(c=e.response)||null==(o=c.data)?void 0:o.message)=="No token, authorization denied")&&this.logout(),Promise.reject(e))})}}}}]);